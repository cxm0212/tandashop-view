{"remainingRequest":"E:\\资料整理cxm\\sihuo项目\\weichat\\tandashop\\tdshop-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\资料整理cxm\\sihuo项目\\weichat\\tandashop\\tdshop-view\\src\\views\\course\\courseLoopImages.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\资料整理cxm\\sihuo项目\\weichat\\tandashop\\tdshop-view\\src\\views\\course\\courseLoopImages.vue","mtime":1589965083893},{"path":"E:\\资料整理cxm\\sihuo项目\\weichat\\tandashop\\tdshop-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1589772030553},{"path":"E:\\资料整理cxm\\sihuo项目\\weichat\\tandashop\\tdshop-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1589772028696},{"path":"E:\\资料整理cxm\\sihuo项目\\weichat\\tandashop\\tdshop-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1589772030553},{"path":"E:\\资料整理cxm\\sihuo项目\\weichat\\tandashop\\tdshop-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1589772043896}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgJCBmcm9tICdqcXVlcnknOw0KaW1wb3J0IGh0dHBBcGkgZnJvbSAnLi4vLi4vYXBpL2h0dHAnOw0KaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsNCg0KY29uc3QgZmlsZVVpZFJlYWxJZD17fTsNCg0KZnVuY3Rpb24gZ2V0QmFzZTY0KGltZykgew0KICANCiAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgIC8vIHJlYWRlci5hZGRFdmVudExpc3RlbmVyKCJsb2FkIiwgKCkgPT4gY2FsbGJhY2socmVhZGVyLnJlc3VsdCkpOw0KICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGltZyk7DQogIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgcmVhZGVyLm9ubG9hZCA9ICgpID0+IHJlc29sdmUocmVhZGVyLnJlc3VsdCk7DQogICAgcmVhZGVyLm9uZXJyb3IgPSBlcnJvciA9PiByZWplY3QoZXJyb3IpOw0KICB9KTsNCn0NCmV4cG9ydCBkZWZhdWx0IHsNCiAgcHJvcHM6Wydjb3Vyc2VJZCcsJ3R5cGUnXSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgcHJldmlld1Zpc2libGU6IGZhbHNlLA0KICAgICAgcHJldmlld0ltYWdlOiAnJywNCiAgICAgIGZpbGVMaXN0OiBbXSwNCiAgICAgIGZpbGVVaWRSZWFsSWQsDQogICAgfTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGhhbmRsZUNhbmNlbCgpIHsNCiAgICAgIHRoaXMucHJldmlld1Zpc2libGUgPSBmYWxzZTsNCiAgICB9LA0KICAgIGFzeW5jIGhhbmRsZVByZXZpZXcoZmlsZSkgew0KICAgICAgaWYgKCFmaWxlLnVybCAmJiAhZmlsZS5wcmV2aWV3KSB7DQogICAgICAgIGZpbGUucHJldmlldyA9IGF3YWl0IGdldEJhc2U2NChmaWxlLm9yaWdpbkZpbGVPYmopOw0KICAgICAgfQ0KICAgICAgdGhpcy5wcmV2aWV3SW1hZ2UgPSBmaWxlLnVybCB8fCBmaWxlLnByZXZpZXc7DQogICAgICB0aGlzLnByZXZpZXdWaXNpYmxlID0gdHJ1ZTsNCiAgICB9LA0KICAgIGhhbmRsZUNoYW5nZSh7ZmlsZSxmaWxlTGlzdH0pIHsNCiAgICAgIHRoaXMuZmlsZUxpc3QgPSBmaWxlTGlzdDsNCiAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOw0KICAgICAgZm9ybURhdGEuYXBwZW5kKCJjb3Vyc2VJZCIsdGhpcy5jb3Vyc2VJZCk7DQogICAgICBmb3JtRGF0YS5hcHBlbmQoInR5cGUiLHRoaXMudHlwZSk7DQogICAgICBmb3JtRGF0YS5hcHBlbmQoImN1ckltZ0lkIiwtMSk7DQogICAgICBmb3JtRGF0YS5hcHBlbmQoImZpbGUiLGZpbGUpOw0KICAgICAgLy8gY29uc29sZS5sb2coZmlsZSk7DQogICAgICANCiAgICAgIGF4aW9zLnBvc3QoaHR0cEFwaS51cGxvYWRmaWxlVXJsLGZvcm1EYXRhKS50aGVuKChyZXN1bHQpID0+IHsNCiAgICAgICAgbGV0IGRhdGFzID0gcmVzdWx0LmRhdGE7DQogICAgICAgIGZpbGVVaWRSZWFsSWRbZmlsZS51aWRdPSBkYXRhcy5pZDsNCiAgICAgIH0pOw0KDQogICAgfSwNCiAgICBhc3luYyByZW1vdmVJbWcoZmlsZSl7DQogICAgICBsZXQgY3VySW1nSWQgPSBmaWxlVWlkUmVhbElkW2ZpbGUudWlkXTsNCiAgICAgIGNvbnNvbGUubG9nKGN1ckltZ0lkKyItLS0t56e76Zmk5Zu+54mHLS0tIik7DQogICAgICBjb25zb2xlLmxvZyhmaWxlKTsNCiAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOw0KICAgICAgZm9ybURhdGEuYXBwZW5kKCJjb3Vyc2VJZCIsdGhpcy5jb3Vyc2VJZCk7DQogICAgICBmb3JtRGF0YS5hcHBlbmQoImN1ckltZ0lkIixjdXJJbWdJZCk7DQogICAgICBhd2FpdCBheGlvcy5wb3N0KGh0dHBBcGkucmVtb3ZlRmlsZVVybCxmb3JtRGF0YSk7DQogICAgICB0aGlzLmZpbGVMaXN0LnNwbGljZSgkLmluQXJyYXkoZmlsZSx0aGlzLmZpbGVMaXN0KSwxKQ0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0sDQogICANCiAgICBiZWZvcmVVcGxvYWQoKSB7DQogICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICB9LA0KICANCn07DQo="},{"version":3,"sources":["courseLoopImages.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA","file":"courseLoopImages.vue","sourceRoot":"src/views/course","sourcesContent":["<template>\r\n  <div class=\"clearfix\">\r\n    <a-upload\r\n      list-type=\"picture-card\"\r\n      :file-list=\"fileList\"\r\n      @preview=\"handlePreview\"\r\n      :beforeUpload=\"beforeUpload\"\r\n      @change=\"handleChange\"\r\n      :remove=\"removeImg\"\r\n    >\r\n      <div v-if=\"fileList.length < 58\">\r\n        <a-icon type=\"plus\" />\r\n        <div class=\"ant-upload-text\">\r\n          Upload\r\n        </div>\r\n      </div>\r\n    </a-upload>\r\n    <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"handleCancel\">\r\n      <img alt=\"example\" style=\"width: 100%\" :src=\"previewImage\" />\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n<script>\r\nimport $ from 'jquery';\r\nimport httpApi from '../../api/http';\r\nimport axios from 'axios';\r\n\r\nconst fileUidRealId={};\r\n\r\nfunction getBase64(img) {\r\n  \r\n    const reader = new FileReader();\r\n    // reader.addEventListener(\"load\", () => callback(reader.result));\r\n    reader.readAsDataURL(img);\r\n  return new Promise((resolve, reject) => {\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n  });\r\n}\r\nexport default {\r\n  props:['courseId','type'],\r\n  data() {\r\n    return {\r\n      previewVisible: false,\r\n      previewImage: '',\r\n      fileList: [],\r\n      fileUidRealId,\r\n    };\r\n  },\r\n  methods: {\r\n    handleCancel() {\r\n      this.previewVisible = false;\r\n    },\r\n    async handlePreview(file) {\r\n      if (!file.url && !file.preview) {\r\n        file.preview = await getBase64(file.originFileObj);\r\n      }\r\n      this.previewImage = file.url || file.preview;\r\n      this.previewVisible = true;\r\n    },\r\n    handleChange({file,fileList}) {\r\n      this.fileList = fileList;\r\n      let formData = new FormData();\r\n      formData.append(\"courseId\",this.courseId);\r\n      formData.append(\"type\",this.type);\r\n      formData.append(\"curImgId\",-1);\r\n      formData.append(\"file\",file);\r\n      // console.log(file);\r\n      \r\n      axios.post(httpApi.uploadfileUrl,formData).then((result) => {\r\n        let datas = result.data;\r\n        fileUidRealId[file.uid]= datas.id;\r\n      });\r\n\r\n    },\r\n    async removeImg(file){\r\n      let curImgId = fileUidRealId[file.uid];\r\n      console.log(curImgId+\"----移除图片---\");\r\n      console.log(file);\r\n      let formData = new FormData();\r\n      formData.append(\"courseId\",this.courseId);\r\n      formData.append(\"curImgId\",curImgId);\r\n      await axios.post(httpApi.removeFileUrl,formData);\r\n      this.fileList.splice($.inArray(file,this.fileList),1)\r\n      return false;\r\n    },\r\n   \r\n    beforeUpload() {\r\n      return false;\r\n    }\r\n  },\r\n  \r\n};\r\n</script>\r\n<style>\r\n/* you can make up upload button and sample style by using stylesheets */\r\n.ant-upload-select-picture-card i {\r\n  font-size: 32px;\r\n  color: #999;\r\n}\r\n\r\n.ant-upload-select-picture-card .ant-upload-text {\r\n  margin-top: 8px;\r\n  color: #666;\r\n}\r\n</style>"]}]}